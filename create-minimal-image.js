// æœ€å°é™ã®JPEGç”»åƒã‚’ä½œæˆï¼ˆã‚µã‚¤ã‚ºæœ€é©åŒ–ï¼‰
const fetch = require('node-fetch');

const accessToken = process.env.LINE_CHANNEL_ACCESS_TOKEN || 'YOUR_ACCESS_TOKEN';
const richMenuId = 'richmenu-6197ec946c3b2572dfe3be9ea132e9e0';

// æœ€å°é™ã®æœ‰åŠ¹ãªJPEGï¼ˆ2500x843ï¼‰
function createMinimalJPEG() {
  return Buffer.from([
    // JPEG SOI
    0xFF, 0xD8,
    
    // JFIF APP0
    0xFF, 0xE0, 0x00, 0x10, 0x4A, 0x46, 0x49, 0x46, 0x00, 0x01, 0x01, 0x01, 0x00, 0x48, 0x00, 0x48, 0x00, 0x00,
    
    // DQT
    0xFF, 0xDB, 0x00, 0x43, 0x00,
    0x10, 0x0B, 0x0C, 0x0E, 0x0C, 0x0A, 0x10, 0x0E, 0x0D, 0x0E, 0x12, 0x11, 0x10, 0x13, 0x18, 0x28,
    0x1A, 0x18, 0x16, 0x16, 0x18, 0x31, 0x23, 0x25, 0x1D, 0x28, 0x3A, 0x33, 0x3D, 0x3C, 0x39, 0x33,
    0x38, 0x37, 0x40, 0x48, 0x5C, 0x4E, 0x40, 0x44, 0x57, 0x45, 0x37, 0x38, 0x50, 0x6D, 0x51, 0x57,
    0x5F, 0x62, 0x67, 0x68, 0x67, 0x3E, 0x4D, 0x71, 0x79, 0x70, 0x64, 0x78, 0x5C, 0x65, 0x67, 0x63,
    
    // SOF0 - Start of Frame (2500x843)
    0xFF, 0xC0, 0x00, 0x11, 0x08,
    0x03, 0x4B, // Height: 843
    0x09, 0xC4, // Width: 2500
    0x03, 0x01, 0x22, 0x00, 0x02, 0x11, 0x01, 0x03, 0x11, 0x01,
    
    // DHT
    0xFF, 0xC4, 0x00, 0x1F, 0x00, 0x00, 0x01, 0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B,
    
    // SOS - Start of Scan
    0xFF, 0xDA, 0x00, 0x0C, 0x03, 0x01, 0x00, 0x02, 0x11, 0x03, 0x11, 0x00, 0x3F, 0x00,
    
    // åœ§ç¸®ã•ã‚ŒãŸç”»åƒãƒ‡ãƒ¼ã‚¿ï¼ˆæœ€å°é™ï¼‰
    0xFE, 0x8A, 0x28, 0xAA, 0x8A, 0x28, 0xAA, 0x8A, 0x28, 0xAA, 0x8A, 0x28, 0xAA, 0x8A, 0x28, 0xAA,
    0x8A, 0x28, 0xAA, 0x8A, 0x28, 0xAA, 0x8A, 0x28, 0xAA, 0x8A, 0x28, 0xAA, 0x8A, 0x28, 0xAA,
    
    // EOI - End of Image
    0xFF, 0xD9
  ]);
}

async function uploadMinimalImage() {
  try {
    console.log('æœ€å°é™JPEGç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­...');
    
    const imageBuffer = createMinimalJPEG();
    console.log('ç”»åƒã‚µã‚¤ã‚º:', imageBuffer.length, 'bytes');
    
    const response = await fetch(`https://api-data.line.me/v2/bot/richmenu/${richMenuId}/content`, {
      method: 'POST',
      headers: {
        'Content-Type': 'image/jpeg',
        'Authorization': `Bearer ${accessToken}`,
      },
      body: imageBuffer,
    });

    if (response.ok) {
      console.log('âœ… æœ€å°JPEGç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸï¼');
      console.log('ğŸ‰ ã“ã‚Œã§ãƒªãƒƒãƒãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ï¼');
    } else {
      const error = await response.text();
      console.error('âŒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—:', error);
    }

  } catch (error) {
    console.error('ã‚¨ãƒ©ãƒ¼:', error);
  }
}

uploadMinimalImage();